<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0063)http://online-judge.uva.es/contest/data/0157/problemset/p4.html -->
<HTML xmlns="http://www.w3.org/TR/REC-html40" xmlns:v = 
"urn:schemas-microsoft-com:vml" xmlns:o = 
"urn:schemas-microsoft-com:office:office" xmlns:w = 
"urn:schemas-microsoft-com:office:word" xmlns:st1 = 
"urn:schemas-microsoft-com:office:smarttags"><HEAD><TITLE>Problem E</TITLE>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<META content=Word.Document name=ProgId>
<META content="MSHTML 6.00.2900.2180" name=GENERATOR>
<META content="Microsoft Word 11" name=Originator><LINK 
href="E_files/editdata.mso" rel=Edit-Time-Data><o:SmartTagType name="place" 
namespaceuri="urn:schemas-microsoft-com:office:smarttags"></o:SmartTagType><o:SmartTagType 
name="State" 
namespaceuri="urn:schemas-microsoft-com:office:smarttags"></o:SmartTagType><o:SmartTagType 
name="City" 
namespaceuri="urn:schemas-microsoft-com:office:smarttags"></o:SmartTagType><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>PC01</o:Author>
  <o:LastAuthor>PC01</o:LastAuthor>
  <o:Revision>14</o:Revision>
  <o:TotalTime>91</o:TotalTime>
  <o:Created>2006-10-20T16:15:00Z</o:Created>
  <o:LastSaved>2006-10-20T18:06:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>262</o:Words>
  <o:Characters>1495</o:Characters>
  <o:Lines>12</o:Lines>
  <o:Paragraphs>3</o:Paragraphs>
  <o:CharactersWithSpaces>1754</o:CharactersWithSpaces>
  <o:Version>11.5606</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<STYLE>@page Section1 {size: 8.5in 11.0in; margin: 1.0in 1.25in 1.0in 1.25in; mso-header-margin: .5in; mso-footer-margin: .5in; mso-paper-source: 0; }
P.MsoNormal {
	FONT-SIZE: 12pt; MARGIN: 0in 0in 0pt; FONT-FAMILY: "Times New Roman"; mso-style-parent: ""; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"
}
LI.MsoNormal {
	FONT-SIZE: 12pt; MARGIN: 0in 0in 0pt; FONT-FAMILY: "Times New Roman"; mso-style-parent: ""; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"
}
DIV.MsoNormal {
	FONT-SIZE: 12pt; MARGIN: 0in 0in 0pt; FONT-FAMILY: "Times New Roman"; mso-style-parent: ""; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"
}
H1 {
	FONT-WEIGHT: bold; FONT-SIZE: 16pt; MARGIN: 0in 0in 0pt; FONT-FAMILY: "Times New Roman"; mso-pagination: widow-orphan; mso-outline-level: 1; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt
}
A:link {
	COLOR: blue; TEXT-DECORATION: underline; text-underline: single
}
SPAN.MsoHyperlink {
	COLOR: blue; TEXT-DECORATION: underline; text-underline: single
}
A:visited {
	COLOR: blue; TEXT-DECORATION: underline; text-underline: single
}
SPAN.MsoHyperlinkFollowed {
	COLOR: blue; TEXT-DECORATION: underline; text-underline: single
}
P {
	FONT-SIZE: 12pt; MARGIN-LEFT: 0in; MARGIN-RIGHT: 0in; FONT-FAMILY: "Times New Roman"; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto
}
PRE {
	FONT-SIZE: 10pt; MARGIN: 0in 0in 0pt; FONT-FAMILY: "Courier New"; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt
}
SPAN.stylearial16pt {
	FONT-WEIGHT: bold; mso-style-name: stylearial16pt
}
DIV.Section1 {
	page: Section1
}
OL {
	MARGIN-BOTTOM: 0in
}
UL {
	MARGIN-BOTTOM: 0in
}
</STYLE>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
<META http-equiv=Content-Language content=en-us></HEAD>
<BODY lang=EN-US style="tab-interval: .5in" vLink=blue link=blue>
<DIV class=Section1>
<P class=MsoNormal style="TEXT-ALIGN: center" align=center><B><SPAN 
style="FONT-SIZE: 28pt; FONT-FAMILY: Arial">Problem E</SPAN></B><SPAN 
style="FONT-FAMILY: Arial"><BR></SPAN><B><SPAN 
style="FONT-SIZE: 20pt; FONT-FAMILY: Arial">&nbsp;S.O.S. </SPAN></B><SPAN 
style="FONT-SIZE: 20pt; FONT-FAMILY: Arial"><BR></SPAN><B><SPAN 
style="FONT-FAMILY: Arial">Time Limit: </SPAN></B><SPAN 
style="FONT-FAMILY: Arial">3</SPAN><SPAN style="FONT-FAMILY: Arial"> Seconds 
<o:p></o:p></SPAN></P>
<P class=MsoNormal style="TEXT-ALIGN: center" align=center><SPAN 
style="FONT-FAMILY: Arial"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal style="TEXT-ALIGN: center" align=center><SPAN 
style="FONT-FAMILY: Arial"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal>If you want to know why the name of this problem is “S.O.S.”, 
go to <U>ce.aut.ac.ir/~sos</U> ;-)<o:p></o:p></P>
<P class=MsoNormal>There are some fiery buildings in a city and fire fighters 
are trying to control the fire. But the speed of propagation of fire is more 
than what can be controlled. Fire fighters discovered that if they only 
extinguish the boundary of a fire zone, it can be controlled better. To do this, 
they must know how fire spreads.<o:p> Here is the description of fire 
propagation process and structure of buildings:</o:p></P>
<UL style="MARGIN-TOP: 0in" type=disc>
  <LI class=MsoNormal style="tab-stops: list .5in; mso-list: l1 level1 lfo3">A 
  fiery building ignites its neighbors after <B>T </B>cycles.<o:p></o:p> 
  <LI class=MsoNormal 
  style="tab-stops: list .5in; mso-list: l1 level1 lfo3"><B>T</B> is 
  <B>ceiling(10 * a / b)</B>, where ‘<B>a’</B> is the area of non-fired building 
  and ‘<B>b’ </B>is the area of ignited one.<o:p></o:p> 
  <LI class=MsoNormal style="tab-stops: list .5in; mso-list: l1 level1 lfo3">Two 
  buildings are neighbor if their minimum distance be less than <B>30</B> 
  (meters).<o:p></o:p> 
  <LI class=MsoNormal 
  style="tab-stops: list .5in; mso-list: l1 level1 lfo3">Each building is a 
  non-self-intersecting polygon.<o:p></o:p> 
  <LI class=MsoNormal 
  style="tab-stops: list .5in; mso-list: l1 level1 lfo3">Buildings neither 
  overlap nor touch each other.<SPAN style="mso-spacerun: yes">&nbsp; 
  </SPAN><o:p></o:p></LI></UL>
<H1>&nbsp;<o:p></o:p></H1>
<H1><SPAN class=stylearial16pt>Input<U1:P></U1:P></SPAN><SPAN 
style="FONT-FAMILY: Arial"><o:p></o:p></SPAN></H1>
<P class=MsoNormal>First line of input contains an integer <B>T, </B>which is 
the number of test cases, and after that there are <B>T</B> test cases. Each 
test case starts with a number <B>0&lt;M&lt;=100</B>, the number of buildings. 
After that, there are <B>M</B> lines each containing an integer 
<B>3&lt;=L&lt;=33</B> followed by<B> L </B>pair of integers <B>X</B>i and 
<B>Y</B>i (<B>-1000&lt;=Xi, Yi&lt;=1000</B>) as the building apexes in a line 
(either in clockwise or counter clockwise direction). After that, there is an 
integer <B>0&lt;=P&lt;M</B> representing that the <B>P<I><SPAN 
style="FONT-SIZE: 10pt">th</SPAN></I></B> building is ignited in 
<B>Cycle</B>=0.<o:p></o:p></P>
<P class=MsoNormal>Then there is an integer ‘<B>Cycle</B>’ 
<B>0</B>&lt;=<B>Cycle&lt;=300. </B>There is a blank line after each test 
case.<BR>&nbsp;<o:p></o:p></P>
<H1><SPAN class=stylearial16pt>Output<U1:P></U1:P></SPAN><SPAN 
style="FONT-FAMILY: Arial"><o:p></o:p></SPAN></H1>
<P>For each test case, your program must print the indices of ignited buildings 
in cycle = <B>Cycle</B> in increasing order in a single line separated by a 
single space.<o:p> It should be noted that two floating point numbers <B>a</B> 
and <B>b </B>assumed equal if their absolute difference is less than 
10<SUP>-8</SUP>.<BR><BR></o:p><o:p><B>Note. </B></o:p><o:p>Buildings are 
numbered from 0 to M-1 in the order they appear in the input.</o:p></P>
<TABLE 
style="BACKGROUND: rgb(204,204,204) 0% 50%; WIDTH: 6.7in; BORDER-COLLAPSE: collapse; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial" 
cellSpacing=0 cellPadding=0 width=643 bgColor=#cccccc border=1>
  <TBODY>
  <TR bgColor=#0000e0>
    <TD style="FONT-SIZE: 18px" bgColor=#ffffff><B>
      <CENTER>Sample Input</CENTER></B></TD>
    <TD style="FONT-SIZE: 18px" bgColor=#ffffff><B>
      <CENTER>Sample Output</CENTER></B></TD></TR>
  <TR style="mso-yfti-irow: 0; mso-yfti-firstrow: yes; mso-yfti-lastrow: yes">
    <TD 
    style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: windowtext 1pt solid; WIDTH: 239.4pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; mso-border-alt: solid windowtext .5pt" 
    vAlign=top width=319>
      <P class=MsoNormal><B><SPAN style="FONT-FAMILY: Courier New"><FONT 
      size=2>1</FONT><o:p></o:p></SPAN></B></P>
      <P class=MsoNormal><B><SPAN style="FONT-FAMILY: Courier New"><FONT 
      size=2>4</FONT><o:p></o:p></SPAN></B></P>
      <P class=MsoNormal><B><SPAN style="FONT-FAMILY: Courier New"><FONT 
      size=2>4 0 0 0 1 1 1 1 0</FONT><o:p></o:p></SPAN></B></P>
      <P class=MsoNormal><B><SPAN style="FONT-FAMILY: Courier New"><FONT 
      size=2>3 2 2 3 2 3 3</FONT><o:p></o:p></SPAN></B></P>
      <P class=MsoNormal><B><SPAN style="FONT-FAMILY: Courier New"><FONT 
      size=2>4 21 0 22 0 22 1 21 1</FONT><o:p></o:p></SPAN></B></P>
      <P class=MsoNormal><B><SPAN style="FONT-FAMILY: Courier New"><FONT 
      size=2>3 33 2 33 3 34 3</FONT> <o:p></o:p></SPAN></B></P>
      <P class=MsoNormal><B><SPAN style="FONT-FAMILY: Courier New"><FONT 
      size=2>0</FONT><o:p></o:p></SPAN></B></P>
      <P class=MsoNormal><B><SPAN style="FONT-FAMILY: Courier New"><FONT 
      size=2>7</FONT><o:p></o:p></SPAN></B></P>
      <P class=MsoNormal><B><SPAN 
      style="FONT-FAMILY: Arial"><o:p>&nbsp;</o:p></SPAN></B></P></TD>
    <TD 
    style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: medium none; WIDTH: 243pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: inset windowtext .75pt" 
    vAlign=top width=324><PRE><B><FONT size=2>0 1</FONT><o:p></o:p></B></PRE></TD></TR></TBODY></TABLE>
<DIV class=MsoNormal style="TEXT-ALIGN: center" align=center><SPAN 
style="FONT-FAMILY: Arial">
<HR align=center width="100%" SIZE=2>
</SPAN></DIV>
<P class=MsoNormal><B><SPAN style="FONT-FAMILY: Arial">Problem setter: Ali 
Sharifrazavian</SPAN></B><SPAN style="FONT-FAMILY: Arial"><o:p></o:p></SPAN></P>
<P><B><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">1st <st1:place 
w:st="on"><st1:City w:st="on">Amirkabir</st1:City> <st1:State 
w:st="on">UT</st1:State></st1:place> Annual Programming Contest&nbsp;Final 
Round</SPAN></B></P></DIV></BODY></HTML>
