<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0063)http://online-judge.uva.es/contest/data/0157/problemset/p1.html -->
<HTML xmlns="http://www.w3.org/TR/REC-html40" xmlns:v = 
"urn:schemas-microsoft-com:vml" xmlns:o = 
"urn:schemas-microsoft-com:office:office" xmlns:w = 
"urn:schemas-microsoft-com:office:word"><HEAD><TITLE>Problem B</TITLE>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<META content=Word.Document name=ProgId>
<META content="MSHTML 6.00.2900.2180" name=GENERATOR>
<META content="Microsoft Word 9" name=Originator><LINK 
href="http://acm.uva.es/p/v106/d_files/editdata.mso" rel=Edit-Time-Data><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Hossein Azizpour</o:Author>
  <o:LastAuthor>Hossein Azizpour</o:LastAuthor>
  <o:Revision>45</o:Revision>
  <o:TotalTime>150</o:TotalTime>
  <o:LastPrinted>2004-02-14T12:09:00Z</o:LastPrinted>
  <o:Created>2003-04-09T12:45:00Z</o:Created>
  <o:LastSaved>2004-02-20T06:50:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>254</o:Words>
  <o:Characters>1453</o:Characters>
  <o:Company>BUET &amp; SOFTNET</o:Company>
  <o:Lines>12</o:Lines>
  <o:Paragraphs>2</o:Paragraphs>
  <o:CharactersWithSpaces>1784</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Print</w:View>
  <w:Zoom>BestFit</w:Zoom>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  <w:GrammarState>Clean</w:GrammarState>
 </w:WordDocument>
</xml><![endif]-->
<STYLE>@font-face {
	font-family: Arial Unicode MS;
}
@font-face {
	font-family: @Arial Unicode MS;
}
@page Section1 {size: 8.5in 11.0in; margin: 1.0in 1.0in 1.0in 1.0in; mso-header-margin: 35.3pt; mso-footer-margin: 35.3pt; mso-paper-source: 0; }
SPAN.GRAME {
	mso-gram-e: yes
}
P.MsoNormal {
	FONT-SIZE: 12pt; MARGIN: 0in 0in 0pt; FONT-FAMILY: "Times New Roman"; mso-style-parent: ""; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"
}
LI.MsoNormal {
	FONT-SIZE: 12pt; MARGIN: 0in 0in 0pt; FONT-FAMILY: "Times New Roman"; mso-style-parent: ""; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"
}
DIV.MsoNormal {
	FONT-SIZE: 12pt; MARGIN: 0in 0in 0pt; FONT-FAMILY: "Times New Roman"; mso-style-parent: ""; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"
}
H1 {
	FONT-WEIGHT: bold; FONT-SIZE: 16pt; MARGIN: 0in 0in 0pt; FONT-FAMILY: "Times New Roman"; mso-pagination: widow-orphan; mso-style-next: Normal; mso-outline-level: 1; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt; mso-bidi-font-size: 18.0pt; mso-font-kerning: 0pt
}
P.MsoCaption {
	FONT-WEIGHT: bold; FONT-SIZE: 12pt; MARGIN: 0in 0in 0pt; FONT-FAMILY: "Times New Roman"; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-style-next: Normal
}
LI.MsoCaption {
	FONT-WEIGHT: bold; FONT-SIZE: 12pt; MARGIN: 0in 0in 0pt; FONT-FAMILY: "Times New Roman"; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-style-next: Normal
}
DIV.MsoCaption {
	FONT-WEIGHT: bold; FONT-SIZE: 12pt; MARGIN: 0in 0in 0pt; FONT-FAMILY: "Times New Roman"; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-style-next: Normal
}
P.MsoBodyText {
	FONT-SIZE: 12pt; MARGIN-LEFT: 0in; COLOR: black; MARGIN-RIGHT: 0in; FONT-FAMILY: "Times New Roman"; TEXT-ALIGN: justify; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-ansi-language: EN
}
LI.MsoBodyText {
	FONT-SIZE: 12pt; MARGIN-LEFT: 0in; COLOR: black; MARGIN-RIGHT: 0in; FONT-FAMILY: "Times New Roman"; TEXT-ALIGN: justify; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-ansi-language: EN
}
DIV.MsoBodyText {
	FONT-SIZE: 12pt; MARGIN-LEFT: 0in; COLOR: black; MARGIN-RIGHT: 0in; FONT-FAMILY: "Times New Roman"; TEXT-ALIGN: justify; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-ansi-language: EN
}
P.MsoBodyText2 {
	FONT-SIZE: 12pt; MARGIN-LEFT: 0in; MARGIN-RIGHT: 0in; FONT-FAMILY: "Times New Roman"; TEXT-ALIGN: justify; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto
}
LI.MsoBodyText2 {
	FONT-SIZE: 12pt; MARGIN-LEFT: 0in; MARGIN-RIGHT: 0in; FONT-FAMILY: "Times New Roman"; TEXT-ALIGN: justify; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto
}
DIV.MsoBodyText2 {
	FONT-SIZE: 12pt; MARGIN-LEFT: 0in; MARGIN-RIGHT: 0in; FONT-FAMILY: "Times New Roman"; TEXT-ALIGN: justify; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto
}
A:link {
	COLOR: blue; TEXT-DECORATION: underline; text-underline: single
}
SPAN.MsoHyperlink {
	COLOR: blue; TEXT-DECORATION: underline; text-underline: single
}
A:visited {
	COLOR: blue; TEXT-DECORATION: underline; text-underline: single
}
SPAN.MsoHyperlinkFollowed {
	COLOR: blue; TEXT-DECORATION: underline; text-underline: single
}
P {
	FONT-SIZE: 12pt; MARGIN-LEFT: 0in; MARGIN-RIGHT: 0in; FONT-FAMILY: "Times New Roman"; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto
}
PRE {
	FONT-SIZE: 10pt; MARGIN: 0in 0in 0pt; FONT-FAMILY: "Courier New"; mso-pagination: widow-orphan; mso-fareast-font-family: "Courier New"; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt
}
SPAN.StyleArial16pt {
	FONT-WEIGHT: bold; mso-style-name: "Style Arial 16 pt"; mso-ansi-font-size: 16.0pt; mso-ascii-font-family: Arial; mso-hansi-font-family: Arial; mso-bidi-font-family: Arial
}
DIV.Section1 {
	page: Section1
}
</STYLE>
<!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
<META content=Exponentiation name=description>
<META content=htmlatex name=keywords>
<META content=document name=resource-type>
<META content=global name=distribution></HEAD>
<BODY lang=EN-US dir=ltr vLink=blue link=blue bgColor=white>
<DIV class=Section1>
<P class=MsoNormal style="TEXT-ALIGN: center" align=center><B><SPAN 
style="FONT-SIZE: 28pt; FONT-FAMILY: Arial">Problem B</SPAN></B><SPAN 
style="FONT-FAMILY: Arial"><BR></SPAN><B><SPAN 
style="FONT-SIZE: 20pt; FONT-FAMILY: Arial">&nbsp;Sugar Cubes</SPAN></B><SPAN 
style="FONT-SIZE: 20pt; FONT-FAMILY: Arial"><BR></SPAN><SPAN 
style="FONT-FAMILY: Arial"><B>Time Limit: </B>5 Seconds</SPAN></P>
<P style="TEXT-ALIGN: justify">Pezz likes to chew sugar cubes so much! Since he 
is fasting today,&nbsp;he wants to play with his <STRONG>N </STRONG>sugar cubes 
instead of eating them! He assigned indices&nbsp;<STRONG>1, 2, ..., N 
</STRONG>to his&nbsp;cubes and&nbsp;also, he has written&nbsp;a random number 
between <B>1</B> and <B>6 </B>(inclusive) on each side of these&nbsp;<B>N</B> 
sugar cubes. Now, he wants to arrange the sugar cubes in a row from left to 
right&nbsp;according to the following&nbsp;rules: Let the sugar cubes in a 
arrangement be <STRONG>s1, s2, ..., sk</STRONG>, where 
<STRONG>1&lt;=k&lt;=N</STRONG>.<STRONG>&nbsp;</STRONG>By<STRONG> si.left 
</STRONG>and<STRONG> si.right</STRONG>&nbsp;we mean the number&nbsp;on 
the&nbsp;left side and the number of the right side of sugar cube <STRONG>si 
</STRONG>respectively.&nbsp;The arrangement must have this 
property:&nbsp;<STRONG>s1.left&lt;=s1.right&lt;=s2.left&lt;=s2.right&lt;=...&lt;=sk.left&lt;=sk.right</STRONG>. 
In addition, all the cubes <I>having number <STRONG>x </STRONG>in 
the&nbsp;arrangement</I> (i.e.<B> x </B>is on the left side or right side of 
them in the arrangement) should come in increasing sequence of their indices. 
For clarification, see figures below.</P>
<P style="TEXT-ALIGN: justify" align=center>
<CENTER><IMG height=130 src="Problem B_files/fig1.png" width=536 border=0>
<P>a valid arrangement</P>
<P><IMG height=130 src="Problem B_files/fig2.png" width=536 border=0></P>
<P>an invalid arrangement</P></CENTER>
<P></P>
<P style="TEXT-ALIGN: justify">Now Pezz is curious about knowing how many 
arrangements with the above rules exist. Note that two arrangements are 
different if their sequences of indices from left to right are distinct 
or&nbsp;the sequences of numbers on the left side and right side of cubes in the 
arrangements from left to right, i.e. <STRONG>s1.left, s1.right, s2.left, 
s2.right, ..., sk.left, sk.right, </STRONG>are distinct.</P>
<P style="TEXT-ALIGN: center">
<CENTER><IMG height=146 src="Problem B_files/die.jpg" width=214 
border=0></CENTER>
<CENTER><I>Number of each side in a given lump.</I></CENTER>
<P></P>
<H1><SPAN class=StyleArial16pt><SPAN 
style="FONT-FAMILY: Arial">Input<o:p></o:p></SPAN> </SPAN></H1>
<P style="TEXT-ALIGN: justify">The input starts with a single integer<STRONG> T 
</STRONG>showing the number of test cases. Each test case starts with a line 
containing an integer 0&lt; <B>N&lt;=200</B>. Next, there will be <B>N</B> lines 
of exactly <B>6</B> integers denoting the written number on each side of a sugar 
cube respectively (number <STRONG>i</STRONG> in figure above shows the place of 
<STRONG>i</STRONG>th number). There will one blank line after each test 
case.</P>
<H1><SPAN class=StyleArial16pt><SPAN 
style="FONT-FAMILY: Arial">Output<o:p></o:p></SPAN> </SPAN></H1>
<P style="TEXT-ALIGN: justify">For each test case, output a line containing the 
number of different ways that Pezz can arrange sugar cubes modulo 1000000000 in 
a row, using the above rules.</P>
<TABLE 
style="BACKGROUND: rgb(204,204,204) 0% 50%; WIDTH: 6.7in; BORDER-COLLAPSE: collapse; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial" 
cellSpacing=0 cellPadding=0 width=643 bgColor=#cccccc border=1>
  <TBODY>
  <TR bgColor=#0000e0>
    <TD style="FONT-SIZE: 18px" bgColor=#ffffff><B>
      <CENTER>Sample Input</CENTER></B></TD>
    <TD style="FONT-SIZE: 18px" bgColor=#ffffff><B>
      <CENTER>Sample Output</CENTER></B></TD></TR>
  <TR>
    <TD vAlign=top width=319><PRE><B>3
1
1 2 3 4 5 6
</B></PRE><PRE><B>1
1 1 1 1 1 1
</B></PRE><PRE><B>5
</B><B>1 1 1 1 1 1
</B><B>1 1 1 1 1 1
</B><B>1 1 1 1 1 1
</B><B>1 1 1 1 1 1
</B><B>1 1 1 1 1 1
</B></PRE></TD>
    <TD vAlign=top width=324><PRE>3
1
31
</PRE></TD></TR></TBODY></TABLE>
<DIV class=MsoNormal style="TEXT-ALIGN: center" align=center>
<HR align=center width="100%" SIZE=2>
</DIV><FONT face="Times New Roman"><B>Problem setter: Hossein Azizpour &amp; 
</B><STRONG>Mohammad Reza Khani </STRONG></FONT></DIV>
<P><B><FONT style="FONT-SIZE: 10pt" face="Arial, Times New Roman">1st Amirkabir 
UT Annual Programming Contest&nbsp;- Final Round</FONT></B></P></BODY></HTML>
