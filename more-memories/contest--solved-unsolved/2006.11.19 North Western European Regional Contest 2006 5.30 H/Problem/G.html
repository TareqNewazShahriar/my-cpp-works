<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>G - Prime Path</title>

<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link href="G_files/problem.css" type="text/css" rel="stylesheet"></head>

<body>

<h1>Problem G - Prime Path</h1>
<h3>Time limit: 1 second</h3>

<p>
<img src="G_files/p6.jpg">
The ministers of the cabinet were quite upset by the 
message from the Chief of Security stating that they
would all have to change the four-digit room numbers 
on their offices. <br>
&#8212; It is a matter of security to change such things
    every now and then, to keep the enemy in the dark.<br>
&#8212; But look, I have chosen my number 1033 for good
    reasons. I am the Prime minister, you know!<br>
&#8212; I know, so therefore your new number 8179 is also
    a prime. You will just have to paste four new
    digits over the four old ones on your office door.<br>
&#8212; No, it's not that simple. Suppose that I change the
    first digit to an 8, then the number will read 8033
    which is not a prime!<br>
&#8212; I see, being the prime minister you cannot stand
    having a non-prime number on your door even for a
    few seconds.<br>
&#8212; Correct! So I must invent a scheme for going from
    1033 to 8179 by a path of prime numbers where
    only one digit is changed from one prime to the
    next prime.

</p><p>
Now, the minister of finance, who had been eavesdropping,
intervened.<br>
&#8212; No unnecessary expenditure, please! I happen to
    know that the price of a digit is one pound.<br>
&#8212; Hmm, in that case I need a computer program to 
    minimize the cost. You don't know some very cheap
    software gurus, do you?<br>
&#8212; In fact, I do. You see, there is this programming
    contest going on...

</p><p>
Help the prime minister to find the cheapest prime path
between any two given four-digit primes! The first digit
must be nonzero, of course. Here is a solution in the 
case above.
</p><pre>    1033
    1733     
    3733     
    3739     
    3779
    8779
    8179     
</pre>
The cost of this solution is 6 pounds.  Note that the digit 1
which got pasted over in step 2 can not be reused in the last step
&#8211; a new 1 must be purchased.

<h2>Input</h2>
One line with a positive number: the number of test cases (at most
100). Then for each test case, one line with two numbers separated by
a blank.  Both numbers are four-digit primes (without leading zeros).

<h2>Output</h2>
One line for each case, either with a number stating the minimal cost
or containing the word <tt>Impossible</tt>. 

<div class="sample">
<h2>Sample Input</h2>
<pre>3
1033 8179
1373 8017
1033 1033
</pre>
</div>

<div class="sample">
<h2>Sample Output</h2>
<pre>6
7
0
</pre>
</div>

<div class="source">
The 2006 ACM Northwestern European Programming Contest
</div>

</body></html>