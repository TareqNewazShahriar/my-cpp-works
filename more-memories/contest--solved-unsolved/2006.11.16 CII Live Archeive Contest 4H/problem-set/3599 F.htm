<html><head><title>3599 - Go Go Gorelians</title></head><body><table align="center" border="1" cellspacing="0" cellpadding="3"><tbody><tr valign="center"><td valign="center" align="center" rowspan="2"><font color="#0000a0" size="5"><b><img src="3599%20F_files/icono.gif"></b></font></td><td align="center" width="500" colspan="5"><font color="#0000a0" size="5"><b>3599 - Go Go Gorelians</b></font><br><a href="http://acmicpc-live-archive.uva.es/nuevoportal/region.php?r=mc&amp;year=2006"><b>North America - Mid Central - 2006/2007</b></a></td></tr><tr valign="center"><td width="100">&nbsp;</td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/mailer.php?problem=3599"><b>Submit</b></a></td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/rankprob.php?p=3599"><b>Ranking</b></a></td></tr></tbody></table><p>&nbsp;</p><p>
The Gorelians travel through space using warp links. Travel through a
warp link is instantaneous, but for safety reasons, an individual can
only warp once every 10 hours. Also, the cost of creating a warp link
increases directly with the linear distance between the link endpoints.
</p><p>
The Gorelians, being the dominant force in the known universe, are
often bored, so they frequently conquer new regions of space in the
following manner. </p><p>

</p><ol>
<li>The initial invasion force finds a suitable planet and conquers it,
establishing a Regional Gorelian Galactic Government, hereafter
referred to as the RGGG, that will govern all Gorelian matters in this
region of space. </li>
<li>When the next planet is conquered, a single warp link is
constructed between the new planet and the RGGG planet. Planets
connected via warp links in this manner are said to be part of the
Regional Gorelian Planetary Network, that is, the RGPN. </li>
<li>As additional planets are conquered, each new planet is connected
with a single warp link to the nearest planet already in the RGPN, thus
keeping the cost of connecting new planets to the network to a minimum.
If two or more planets are equidistant from the new planet, the new
planet is connected to whichever of them was conquered first. </li>
</ol>

<p>
This causes a problem however. Since planets are conquered in a
more-or-less random fashion, after a while, the RGGG will probably not
be in an ideal location. Some Gorelians needing to consult with the
RGGG might only have to make one or two warps, but others might require
dozens--very inconvenient when one considers the 10-hour waiting period
between warps. </p><p>
So, once each Gorelian year, the RGGG analyzes the RGPN and relocates
itself to an optimal location. The optimal location is defined as a
planet that minimizes the maximum number of warps required to reach the
RGGG from any planet in the RGPN. As it turns out, there is always
exactly one or two such planets. When there are two, they are always
directly adjacent via a warp link, and the RGGG divides itself evenly
between the two planets. </p><p>
Your job is to write a program that finds the optimal planets for the
RGGG. For the purposes of this problem, the region of space conquered
by the Gorelians is defined as a cube that ranges from (0,0,0) to
(1000,1000,1000). </p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001001000000000000000">
Input</a>&nbsp;</font>
</h2> 

<p>
The input consists of a set of scenarios where the Gorelians conquer a
region of space. Each scenario is independent. The first line of the
scenario is an integer <span class="MATH"><i>N</i></span> that specifies the total number of planets conquered by the Gorelians. The next <span class="MATH"><i>N</i></span> lines of the input specify, in the order conquered, the <span class="MATH"><i>ID</i></span>s and coordinates of the conquered planets to be added to the RGPN, in the format <!-- MATH
 $ID \ X \ Y \ Z$
 -->
<span class="MATH"><i>ID</i>&nbsp;<i>X</i>&nbsp;<i>Y</i>&nbsp;<i>Z</i></span>. An <span class="MATH"><i>ID</i></span> is an integer from 1 to 1000. <span class="MATH"><i>X</i></span>, <span class="MATH"><i>Y</i></span>, and <span class="MATH"><i>Z</i></span> are integers from 0 to 1000. A single space separates the numbers. A value of <span class="MATH"><i>N</i> = 0</span> marks the end of the input. 

</p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001002000000000000000">
Output</a>&nbsp;</font>
</h2> 

<p>
For each input scenario, output the <span class="MATH"><i>ID</i></span>s of the optimal planet or planets where the RGGG should relocate. For a single planet, simply output the planet <span class="MATH"><i>ID</i></span>. For two planets, output the planet <span class="MATH"><i>ID</i></span>s, smallest <span class="MATH"><i>ID</i></span> first, separated by a single space.

</p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001003000000000000000">
Sample Input</a>&nbsp;</font>
</h2> 

<p>
</p><pre>5 
1 0 0 0 
2 0 0 1 
3 0 0 2 
4 0 0 3 
5 0 0 4 
5 
1 0 0 0 
2 1 1 0 
3 3 2 0 
4 2 1 0 
5 3 0 0 
10 
21 71 76 4 
97 32 5 69 
70 33 19 35 
3 79 81 8 
31 91 17 67 
52 31 48 75 
48 90 14 4 
41 73 2 21 
83 74 41 69 
26 32 30 24 
0
</pre> 

<p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001004000000000000000">
Sample Output</a>&nbsp;</font>
</h2> 

<p>
</p><pre>3 
2 4 
31 97
</pre> 

<p>
</p><hr><address>Mid Central 2006-2007</address><p></p></body></html>