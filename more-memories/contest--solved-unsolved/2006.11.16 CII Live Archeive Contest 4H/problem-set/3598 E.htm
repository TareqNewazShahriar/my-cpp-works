<html><head><title>3598 - Frugal Search</title></head><body><table align="center" border="1" cellspacing="0" cellpadding="3"><tbody><tr valign="center"><td valign="center" align="center" rowspan="2"><font color="#0000a0" size="5"><b><img src="3598%20E_files/icono.gif"></b></font></td><td align="center" width="500" colspan="5"><font color="#0000a0" size="5"><b>3598 - Frugal Search</b></font><br><a href="http://acmicpc-live-archive.uva.es/nuevoportal/region.php?r=mc&amp;year=2006"><b>North America - Mid Central - 2006/2007</b></a></td></tr><tr valign="center"><td width="100">&nbsp;</td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/mailer.php?problem=3598"><b>Submit</b></a></td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/rankprob.php?p=3598"><b>Ranking</b></a></td></tr></tbody></table><p>&nbsp;</p><p>
For this problem you will write a search engine that takes a query,
searches a collection of words, and finds the lexicographically
smallest word that matches the query (i.e., the matching word that
would appear first in an English dictionary). A <span class="textit">query</span> is a sequence of one or more terms separated by single vertical bars (``<tt>|</tt>"). A <span class="textit">term</span> is one or more letters followed by zero or more signed letters. A <span class="textit">signed</span> letter is either <tt>+</tt><span class="MATH"><i>s</i></span> (`positive" <span class="MATH"><i>s</i></span>) or <tt>-</tt><span class="MATH"><i>s</i></span> (``negative" <span class="MATH"><i>s</i></span>), where <span class="MATH"><i>s</i></span>
is a single letter. All letters are lowercase, and no letter will
appear more than once within a term. A query will not contain spaces. A
term matches a word if the word contains at least one of the unsigned
letters, all of the positive letters, and none of the negative letters;
a query matches a word if at least one of its terms matches the word. </p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001001000000000000000">
Input</a>&nbsp;</font>
</h2> 

<p>
The input consists of one or more test cases followed by a line containing only ``<tt>#</tt>"
that signals the end of the input. Each test case consists of 1â&#8364;&#8220;100
words, each on a line by itself, followed by a line containing only ``<tt><span class="MATH"><tt>*</tt></span></tt>"
that marks the end of the word list, followed by one or more queries,
each on a line by itself, followed by a line containing only ``<tt><span class="MATH"><tt>*</tt> <tt>*</tt></span></tt>"
that marks the end of the test case. Each word will consist of 1-20
lowercase letters. All words within a test case will be unique. Each
query will be as defined above and will be 1-79 characters long. </p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001002000000000000000">
Output</a>&nbsp;</font>
</h2> 

<p>
For each query, output a single line containing the lexicographically smallest word <span class="textit">within that test case</span> that matches the query, or the word <tt>NONE</tt> if there is no matching word. At the end of each test case, output a dollar sign on a line by itself. 

</p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001003000000000000000">
Sample Input</a>&nbsp;</font>
</h2> 

<p>
</p><pre>elk 
cow 
bat 
* 
ea 
acm+e 
nm+o|jk+l 
** 
debian 
slackware 
gentoo 
ubuntu 
suse 
fedora 
mepis 
* 
yts 
cab-e+n 
r-e|zjq|i+t|vs-p+e-u-c 
** 
#
</pre>  

<p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001004000000000000000">
Sample Output</a>&nbsp;</font>
</h2> 

<p>
</p><pre>bat 
NONE 
elk 
$ 
gentoo 
ubuntu 
NONE 
$
</pre> 

<p>
</p><hr><address>Mid Central 2006-2007</address><p></p></body></html>